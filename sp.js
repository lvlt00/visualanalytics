
const data = {
    "Austria": [
        { "year": 2011, "dosage": 57.2 },
        { "year": 2012, "dosage": 58.3 },
        { "year": 2013, "dosage": 59.6 },
        { "year": 2014, "dosage": 60.6 },
        { "year": 2015, "dosage": 60.6 },
        { "year": 2016, "dosage": 60.8 },
        { "year": 2017, "dosage": 61 },
        { "year": 2018, "dosage": 61.3 },
        { "year": 2019, "dosage": 62 },
        { "year": 2020, "dosage": 63.2 },
        { "year": 2021, "dosage": 63.5 }
      ],
      "Belgium": [
        { "year": 2011, "dosage": 70 },
        { "year": 2012, "dosage": 70.4 },
        { "year": 2013, "dosage": 72.1 },
        { "year": 2014, "dosage": 74.9 },
        { "year": 2015, "dosage": 77.5 },
        { "year": 2016, "dosage": 79 },
        { "year": 2017, "dosage": 78.8 },
        { "year": 2018, "dosage": 79.7 },
        { "year": 2019, "dosage": 81.9 },
        { "year": 2020, "dosage": 83.8 },
        { "year": 2021, "dosage": 86.2 }
      ],
  
      "Czechia": [
        { "year": 2011, "dosage": 44.1 },
        { "year": 2012, "dosage": 46.2 },
        { "year": 2013, "dosage": 49 },
        { "year": 2014, "dosage": 52.7 },
        { "year": 2015, "dosage": 55 },
        { "year": 2016, "dosage": 57.1 },
        { "year": 2017, "dosage": 59.9 },
        { "year": 2018, "dosage": 61.4 },
        { "year": 2019, "dosage": 64.4 },
        { "year": 2020, "dosage": 65.7 },
        { "year": 2021, "dosage": 69.4 }
      ],
      "Denmark": [
        { "year": 2011, "dosage": 85.2 },
        { "year": 2012, "dosage": 83.2 },
        { "year": 2013, "dosage": 80 },
        { "year": 2014, "dosage": 76.6 },
        { "year": 2015, "dosage": 77 },
        { "year": 2016, "dosage": 76.4 },
        { "year": 2017, "dosage": 75.7 },
        { "year": 2018, "dosage": 76.6 },
        { "year": 2019, "dosage": 78.3 },
        { "year": 2020, "dosage": 80.7 },
        { "year": 2021, "dosage": 84.6 }
      ],
      "Estonia": [
        { "year": 2011, "dosage": 17.9 },
        { "year": 2012, "dosage": 20.1 },
        { "year": 2013, "dosage": 21.4 },
        { "year": 2014, "dosage": 23.3 },
        { "year": 2015, "dosage": 24.8 },
        { "year": 2016, "dosage": 27.2 },
        { "year": 2017, "dosage": 28.8 },
        { "year": 2018, "dosage": 31.9 },
        { "year": 2019, "dosage": 34.8 },
        { "year": 2020, "dosage": 37 },
        { "year": 2021, "dosage": 40.7 }
      ],
      "Finland": [
        { "year": 2011, "dosage": 70.2 },
        { "year": 2012, "dosage": 69.8 },
        { "year": 2013, "dosage": 69.4 },
        { "year": 2014, "dosage": 68.9 },
        { "year": 2015, "dosage": 68.3 },
        { "year": 2016, "dosage": 67.7 },
        { "year": 2017, "dosage": 70.5 },
        { "year": 2018, "dosage": 74.9 },
        { "year": 2019, "dosage": 78.3 },
        { "year": 2020, "dosage": 81.5 },
        { "year": 2021, "dosage": 85.2 }
      ],
      "France": [
        { "year": 2011, "dosage": 51.7 },
        { "year": 2012, "dosage": 52 },
        { "year": 2013, "dosage": 51.8 },
        { "year": 2014, "dosage": 51.8 },
        { "year": 2015, "dosage": 51.6 },
        { "year": 2016, "dosage": 51.7 },
        { "year": 2017, "dosage": 51.3 },
        { "year": 2018, "dosage": 51.5 },
        { "year": 2019, "dosage": 54.4 },
        { "year": 2020, "dosage": 54.5 },
        { "year": 2021, "dosage": 57.6 }
      ],
      "Germany": [
        { "year": 2011, "dosage": 50 },
        { "year": 2012, "dosage": 51.9 },
        { "year": 2013, "dosage": 53.1 },
        { "year": 2014, "dosage": 55.1 },
        { "year": 2015, "dosage": 56.4 },
        { "year": 2016, "dosage": 56.5 },
        { "year": 2017, "dosage": 56.9 },
        { "year": 2018, "dosage": 58.5 },
        { "year": 2019, "dosage": 60.3 },
        { "year": 2020, "dosage": 62.2 },
        { "year": 2021, "dosage": 64 }
      ],
      "Greece": [
        { "year": 2011, "dosage": 0 },
        { "year": 2012, "dosage": 0 },
        { "year": 2013, "dosage": 44.7 },
        { "year": 2014, "dosage": 44.6 },
        { "year": 2015, "dosage": 48.1 },
        { "year": 2016, "dosage": 0 },
        { "year": 2017, "dosage": 55.1 },
        { "year": 2018, "dosage": 58 },
        { "year": 2019, "dosage": 61 },
        { "year": 2020, "dosage": 65.8 },
        { "year": 2021, "dosage": 70.6 }
      ],
      "Hungary": [
        { "year": 2011, "dosage": 27.3 },
        { "year": 2012, "dosage": 26.8 },
        { "year": 2013, "dosage": 27.5 },
        { "year": 2014, "dosage": 27.7 },
        { "year": 2015, "dosage": 28.3 },
        { "year": 2016, "dosage": 28.4 },
        { "year": 2017, "dosage": 28.8 },
        { "year": 2018, "dosage": 29.3 },
        { "year": 2019, "dosage": 29.5 },
        { "year": 2020, "dosage": 30.4 },
        { "year": 2021, "dosage": 29.8 }
      ],
      "Iceland": [
        { "year": 2011, "dosage": 103.8 },
        { "year": 2012, "dosage": 106.3 },
        { "year": 2013, "dosage": 113.7 },
        { "year": 2014, "dosage": 115.7 },
        { "year": 2015, "dosage": 125.8 },
        { "year": 2016, "dosage": 133 },
        { "year": 2017, "dosage": 138.6 },
        { "year": 2018, "dosage": 142 },
        { "year": 2019, "dosage": 146 },
        { "year": 2020, "dosage": 153.4 },
        { "year": 2021, "dosage": 161.1 }
      ],
      "Italy": [
        { "year": 2011, "dosage": 38.3 },
        { "year": 2012, "dosage": 38.6 },
        { "year": 2013, "dosage": 39 },
        { "year": 2014, "dosage": 39.2 },
        { "year": 2015, "dosage": 39.5 },
        { "year": 2016, "dosage": 39.8 },
        { "year": 2017, "dosage": 40.4 },
        { "year": 2018, "dosage": 41.6 },
        { "year": 2019, "dosage": 42.8 },
        { "year": 2020, "dosage": 43.7 },
        { "year": 2021, "dosage": 44.6 }
      ],
      "Latvia": [
        { "year": 2011, "dosage": 0 },
        { "year": 2012, "dosage": 0 },
        { "year": 2013, "dosage": 9.5 },
        { "year": 2014, "dosage": 10.2 },
        { "year": 2015, "dosage": 11.1 },
        { "year": 2016, "dosage": 12.3 },
        { "year": 2017, "dosage": 13.3 },
        { "year": 2018, "dosage": 15 },
        { "year": 2019, "dosage": 16.1 },
        { "year": 2020, "dosage": 17.6 },
        { "year": 2021, "dosage": 19.8 },
        { "year": 2022, "dosage": 21.5 }
      ],
  
      "Lithuania": [
        { "year": 2011, "dosage": 20.8 },
        { "year": 2012, "dosage": 23.4 },
        { "year": 2013, "dosage": 24.7 },
        { "year": 2014, "dosage": 25.7 },
        { "year": 2015, "dosage": 27.9 },
        { "year": 2016, "dosage": 29.3 },
        { "year": 2017, "dosage": 32.1 },
        { "year": 2018, "dosage": 31.3 },
        { "year": 2019, "dosage": 35.4 },
        { "year": 2020, "dosage": 36.8 },
        { "year": 2021, "dosage": 37.4 }
      ],
      "Luxembourg": [
         { "year": 2011, "dosage": 51.4 },
         { "year": 2012, "dosage": 52 },
         { "year": 2013, "dosage": 53.4 },
         { "year": 2014, "dosage": 56 },
         { "year": 2015, "dosage": 53.7 },
         { "year": 2016, "dosage": 54.2 },
         { "year": 2017, "dosage": 53 },
         { "year": 2018, "dosage": 52.9 },
         { "year": 2019, "dosage": 54.9 },
         { "year": 2020, "dosage": 55.3 },
         { "year": 2021, "dosage": 57.3 }
      ],
      "Netherlands": [
        { "year": 2011, "dosage": 41.6 },
        { "year": 2012, "dosage": 42.4 },
        { "year": 2013, "dosage": 43.3 },
        { "year": 2014, "dosage": 44.3 },
        { "year": 2015, "dosage": 45.5 },
        { "year": 2016, "dosage": 45.9 },
        { "year": 2017, "dosage": 46.2 },
        { "year": 2018, "dosage": 47.2 },
        { "year": 2019, "dosage": 48 },
        { "year": 2020, "dosage": 48.4 },
        { "year": 2021, "dosage": 48.5 }
      ],
      "Norway": [
        { "year": 2011, "dosage": 57.7 },
        { "year": 2012, "dosage": 57.5 },
        { "year": 2013, "dosage": 56.9 },
        { "year": 2014, "dosage": 57.1 },
        { "year": 2015, "dosage": 58 },
        { "year": 2016, "dosage": 57.6 },
        { "year": 2017, "dosage": 57.3 },
        { "year": 2018, "dosage": 56.2 },
        { "year": 2019, "dosage": 57.9 },
        { "year": 2020, "dosage": 58.7 },
        { "year": 2021, "dosage": 61.1 }
      ],
      "Portugal": [
        { "year": 2011, "dosage": 78.3 },
        { "year": 2012, "dosage": 84.5 },
        { "year": 2013, "dosage": 87.5 },
        { "year": 2014, "dosage": 92.1 },
        { "year": 2015, "dosage": 95.1 },
        { "year": 2016, "dosage": 99.5 },
        { "year": 2017, "dosage": 103.8 },
        { "year": 2018, "dosage": 109.3 },
        { "year": 2019, "dosage": 123.7 },
        { "year": 2020, "dosage": 131 },
        { "year": 2021, "dosage": 138.8 }
      ],
      "Slovakia": [
        { "year": 2011, "dosage": 30.7 },
        { "year": 2012, "dosage": 30.2 },
        { "year": 2013, "dosage": 35.2 },
        { "year": 2014, "dosage": 38.1 },
        { "year": 2015, "dosage": 40 },
        { "year": 2016, "dosage": 38.9 },
        { "year": 2017, "dosage": 39.4 },
        { "year": 2018, "dosage": 41.1 },
        { "year": 2019, "dosage": 42.4 },
        { "year": 2020, "dosage": 42.9 },
        { "year": 2021, "dosage": 44.7 }
      ],
      "Slovenia": [
        { "year": 2011, "dosage": 50 },
        { "year": 2012, "dosage": 51 },
        { "year": 2013, "dosage": 53.3 },
        { "year": 2014, "dosage": 55 },
        { "year": 2015, "dosage": 56.8 },
        { "year": 2016, "dosage": 58.6 },
        { "year": 2017, "dosage": 59.5 },
        { "year": 2018, "dosage": 61.5 },
        { "year": 2019, "dosage": 63.3 },
        { "year": 2020, "dosage": 63.6 },
        { "year": 2021, "dosage": 66.1 }
      ],
      "Spain": [
        { "year": 2011, "dosage": 63.9 },
        { "year": 2012, "dosage": 64 },
        { "year": 2013, "dosage": 65.2 },
        { "year": 2014, "dosage": 71.3 },
        { "year": 2015, "dosage": 73.1 },
        { "year": 2016, "dosage": 75.5 },
        { "year": 2017, "dosage": 77.2 },
        { "year": 2018, "dosage": 80.4 },
        { "year": 2019, "dosage": 83.6 },
        { "year": 2020, "dosage": 86.9 },
        { "year": 2021, "dosage": 92.7 }
      ],
      "Sweden": [
        { "year": 2011, "dosage": 79.4 },
        { "year": 2012, "dosage": 81.1 },
        { "year": 2013, "dosage": 84.3 },
        { "year": 2014, "dosage": 87.8 },
        { "year": 2015, "dosage": 92.5 },
        { "year": 2016, "dosage": 95 },
        { "year": 2017, "dosage": 96.9 },
        { "year": 2018, "dosage": 98.8 },
        { "year": 2019, "dosage": 102.7 },
        { "year": 2020, "dosage": 105.5 },
        { "year": 2021, "dosage": 108.9 }
      ],
      "Turkey": [
        { "year": 2011, "dosage": 37 },
        { "year": 2012, "dosage": 37.3 },
        { "year": 2013, "dosage": 36.3 },
        { "year": 2014, "dosage": 38.1 },
        { "year": 2015, "dosage": 40.7 },
        { "year": 2016, "dosage": 41 },
        { "year": 2017, "dosage": 43.5 },
        { "year": 2018, "dosage": 44.1 },
        { "year": 2019, "dosage": 44.2 },
        { "year": 2020, "dosage": 48.9 },
        { "year": 2021, "dosage": 52.5 }
      ],
      "UK": [
        { "year": 2011, "dosage": 70.7 },
        { "year": 2012, "dosage": 75 },
        { "year": 2013, "dosage": 82.3 },
        { "year": 2014, "dosage": 87.8 },
        { "year": 2015, "dosage": 94.2 },
        { "year": 2016, "dosage": 100.1 },
        { "year": 2017, "dosage": 107.9 },
        { "year": 2018, "dosage": 116.5 },
        { "year": 2019, "dosage": 123.9 },
        { "year": 2020, "dosage": 131.7 },
        { "year": 2021, "dosage": 138.2 }
      ] 
};

const svg = d3.select("svg");
const margin = { top: 20, right: 30, bottom: 40, left: 50 };
const width = svg.attr("width") - margin.left - margin.right;
const height = svg.attr("height") - margin.top - margin.bottom;

const xScale = d3.scaleLinear().domain([2011, 2021]).range([0, width]);
const yScale = d3.scaleLinear().domain([0, 160]).range([height, 0]);

const g = svg.append("g")
  .attr("transform", `translate(${margin.left},${margin.top})`);

g.append("g")
  .attr("class", "grid")
  .attr("transform", `translate(0,${height})`)
  .call(d3.axisBottom(xScale)
    .tickSize(-height)         
    .tickFormat(""))           
  .selectAll("line")
  .attr("stroke", "white")
  .attr("stroke-opacity", 0.7);


g.append("g")
  .attr("class", "x-axis")
  .attr("transform", `translate(0,${height})`)
  .call(d3.axisBottom(xScale)
    .tickFormat(d3.format("d"))
    .tickSizeInner(10)         
    .tickSizeOuter(0))         
  .selectAll("text")
  .style("fill", "white")       
  .attr("stroke-opacity", 0.7);

g.append("g")
  .attr("class", "grid")
  .call(d3.axisLeft(yScale)
    .tickSize(-width)          
    .tickFormat(""))           
  .selectAll("line")
  .attr("stroke", "white")
  .attr("stroke-opacity", 0.7);


g.append("g")
  .attr("class", "y-axis")
  .call(d3.axisLeft(yScale)
    .tickSizeInner(10)        
    .tickSizeOuter(0))        
  .selectAll("text")
  .style("fill", "white");      


d3.selectAll(".x-axis .domain, .x-axis .tick line")
  .style("stroke", "white")
  .attr("stroke-width", 1)  
  .attr("stroke-opacity", 0.7);

d3.selectAll(".y-axis .domain, .y-axis .tick line")
  .style("stroke", "white")
  .attr("stroke-width", 1)   
  .attr("stroke-opacity", 0.7);

  const colorMapping = {
    "Austria": "#f44336",   // Red
    "Belgium": "#e81e63",   // Pink
    "Czechia": "#9c27b0",   // Purple
    "Denmark": "#673ab7",   // Deep Purple
    "Estonia": "#3f51b5",   // Indigo
    "Finland": "#12adf9",   // Blue
    "France": "#20f6c2",    // Cyan
    "Germany": "#fee131",   // Yellow
    "Greece": "#009688",    // Teal
    "Hungary": "#4caf50",   // Green
    "Iceland": "#cddc39",   // Lime
    "Italy": "#ff9800",     // Orange
    "Latvia": "#ff5722",    // Deep Orange
    "Lithuania": "#795548", // Brown
    "Luxembourg": "#f7909f", // Baby Pink
    "Netherlands": "#e2647f", // Pink
    "Norway": "#ff0000",    // Red
    "Portugal": "#c1aee1",  // Lavender
    "Slovakia": "#f1dcaf",  // Honey
    "Slovenia": "#ade4cf",  // Coral
    "Spain": "#6f0028",     // Bordeaux
    "Sweden": "#a4bcfa",    // Baby Blue
    "Turkey": "#ffa96a",    // Baby Orange
    "UK": "#f6f386"        // Pastel Yellow
  };

    function toggleCountry(country) {
      const button = d3.select(`button[data-country='${country}']`);
      const isActive = button.classed("active");
      const color = colorMapping[country] || "#ffffff";
      if (isActive) {
      
        g.selectAll(`.dot-${country}`).remove();
        button.classed("active", false).style("background-color", "grey");
      } else {
   
        const countryData = data[country];
        g.selectAll(`.dot-${country}`)
          .data(countryData)
          .enter()
          .append("circle")
          .attr("class", `dot-${country}`)
          .attr("cx", d => xScale(d.year))
          .attr("cy", d => yScale(d.dosage))
          .attr("r", 5)
          .style("fill", color)
          .style("stroke", "white")          // Add white stroke
          .style("stroke-width", "1px"); 
        button.classed("active", true).style("background-color", "orange");
      }
    }


    d3.selectAll(".country-button").on("click", function () {
      const country = d3.select(this).attr("data-country");
      toggleCountry(country);
    });